{
    "name": "reshpc",
    "displayName": "vsHPC Simulation Center",
    "description": "Reservoir HPC Control Center for Launching and Managing Flow and Geomechanics Simulations",
    "publisher": "rogerio-cunha",
    "version": "0.0.1",
    "engines": {
        "vscode": "^1.92.0"
    },
    "categories": [
        "Other"
    ],
    "activationEvents": [
        "workspaceContains:**/(.dat|.gdt|.geo|.DATA|.xml)",
        "onStartupFinished"
    ],
    "icon": "images/icon.png",
    "main": "./out/extension.js",
    "contributes": {
        "walkthroughs": [
            {
                "id": "reshpc.welcome",
                "title": "Starting with resHPC",
                "description": "Abaixo estão as etapas mínimas de configuração que devem ser executadas na extensão para torná-la operacional",
                "steps": [
                    {
                        "id": "reshpc.configureSlurm",
                        "title": "Configurar o account",
                        "description": "Configure as opções do [SLURM](command:reshpc.walkChangeSlurm), inclusive o account (-A account)",
                        "media": {
                            "image": "images/config_account.png",
                            "altText": "account"
                        }
                    },
                    {
                        "id": "reshpc.configuresolver",
                        "title": "Configurar o solver",
                        "description": "Configure o solver utilizado nas simulações\n[Mudar a configuração](command:reshpc.walkChangeSolver)",
                        "media": {
                            "image": "images/config_solver.png",
                            "altText": "solver"
                        }
                    },
                    {
                        "id": "reshpc.configureall",
                        "title": "Acessar as demais configurações",
                        "description": "Veja as demais configurações disponíveis\n[Acessar a configuração](command:reshpc.walkOpenConfig)",
                        "media": {
                            "image": "images/config_all.png",
                            "altText": "config"
                        }
                    },
                    {
                        "id": "reshpc.configuretest",
                        "title": "Testar se a configuração está correta",
                        "description": "Por fim, as configurações podem ser testadas usando a paleta de comandos do VSCODE, na opção HPC: Verificar Configurações\n[Testar a configuração agora](command:reshpc.checkSettings)",
                        "media": {
                            "image": "images/config_test.png",
                            "altText": "config"
                        }
                    },
                    {
                        "id": "reshpc.whatsnew",
                        "title": "Veja as novidades",
                        "description": "Veja as novidades da versão",
                        "media": {
                            "markdown": "NEW.md"
                        }
                    },
                    {
                        "id": "reshpc.readmanual",
                        "title": "Leia a documentação",
                        "description": "Leia o README detalhado da extensão para maiores detalhes\n[Acesse a documentação](command:reshpc.walkOpenReadme)",
                        "media": {
                            "image": "images/config_readme.png",
                            "altText": "readme"
                        }
                    }
                ]
            }
        ],
        "commands": [
            {
                "command": "reshpc.showWelcome",
                "title": "Boas Vindas",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.OpenConfig",
                "title": "Configuração",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmit",
                "title": "Submeter Job com Git",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmitHash",
                "title": "Submeter Job com Git informando o hash",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmitAll",
                "title": "Submeter Jobs com Git (todos os modelos na pasta atual)",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmitDirect",
                "title": "Submeter Job (sem git)",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmitDirectCheck",
                "title": "Verificar sintaxe (checkonly)",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobSubmitDirectOneStep",
                "title": "Submeter Job (onestep)",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobsMgmt",
                "title": "Gerenciar Jobs",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobCheckSSH",
                "title": "Testar o SSH",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.checkSettings",
                "title": "Verificar a configuração",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobEnterPassword",
                "title": "Entrar com a senha SSH",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.jobMock",
                "title": "Enviar Job de teste",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.version",
                "title": "Versão do ResHPC",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.logs",
                "title": "Ver os Logs",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.loadCustomConfiguration",
                "title": "Carregar Configurações Customizadas",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.selectSimulName",
                "title": "Selecionar Simulador",
                "category": "ResHPC"
            },
            {
                "command": "reshpc.selectSimulVersion",
                "title": "Selecionar Versão do Simulador",
                "category": "ResHPC"
            }
        ],
        "submenus": [
            {
                "id": "reshpc.submenu",
                "label": "ResHPC comandos"
            }
        ],
        "menus": {
            "commandPalette": [
                {
                    "command": "reshpc.showWelcome"
                },
                {
                    "command": "reshpc.OpenConfig"
                },
                {
                    "command": "reshpc.jobSubmit"
                },
                {
                    "command": "reshpc.jobSubmitHash"
                },
                {
                    "command": "reshpc.jobSubmitAll",
                    "when": "false"
                },
                {
                    "command": "reshpc.jobsMgmt"
                },
                {
                    "command": "reshpc.jobCheckSSH"
                },
                {
                    "command": "reshpc.checkSettings"
                },
                {
                    "command": "reshpc.version"
                },
                {
                    "command": "reshpc.logs"
                },
                {
                    "command": "reshpc.jobEnterPassword"
                },
                {
                    "command": "reshpc.loadCustomConfiguration"
                },
                {
                    "command": "reshpc.selectSimulName"
                },
                {
                    "command": "reshpc.selectSimulVersion"
                }
            ],
            "editor/context": [
                {
                    "submenu": "reshpc.submenu",
                    "group": "navigation"
                }
            ],
            "editor/title/context": [
                {
                    "submenu": "reshpc.submenu",
                    "group": "navigation"
                }
            ],
            "explorer/context": [
                {
                    "submenu": "reshpc.submenu",
                    "group": "navigation"
                }
            ],
            "reshpc.submenu": [
                {
                    "command": "reshpc.jobSubmit",
                    "when": "resourceExtname =~ /(.dat|.gdt|.geo|.DATA|.xml)/i",
                    "group": "0_reshpc@1"
                },
                {
                    "command": "reshpc.jobSubmitHash",
                    "when": "resourceExtname =~ /(.dat|.gdt|.geo|.DATA|.xml)/i",
                    "group": "0_reshpc@2"
                },
                {
                    "command": "reshpc.jobSubmitDirect",
                    "when": "resourceExtname =~ /(.dat|.gdt|.geo|.DATA|.xml)/i",
                    "group": "0_reshpc@3"
                },
                {
                    "command": "reshpc.jobSubmitAll",
                    "when": "resourceExtname =~ /(.dat|.gdt|.geo|.DATA|.xml)/i",
                    "group": "0_reshpc@4"
                },
                {
                    "command": "reshpc.jobSubmitDirectCheck",
                    "when": "resourceExtname =~ /.dat/i",
                    "group": "0_reshpc@5"
                },
                {
                    "command": "reshpc.jobSubmitDirectOneStep",
                    "when": "resourceExtname =~ /.dat/i",
                    "group": "0_reshpc@6"
                },
                {
                    "command": "reshpc.jobsMgmt",
                    "group": "0_reshpc@11"
                },
                {
                    "command": "reshpc.OpenConfig",
                    "group": "0_reshpc@12"
                }
            ]
        },
        "configuration": [
            {
                "title": "HPC Connection",
                "properties": {

                    "reshpc.connection.cluster": {
                        "type": "string",
                        "markdownDescription": "Head Node do Cluster para submeter jobs (SLURM).",
                        "scope": "application",
                        "order": 1
                    },
                    "reshpc.connection.user": {
                        "type": "string",
                        "markdownDescription": "Usuário (chave) que fará o ssh (e de submissão).",
                        "scope": "application",
                        "order": 2
                    },
                    "reshpc.connection.password": {
                        "type": "string",
                        "markdownDescription": "Senha para acesso via ssh, use o [`resHPC:Entrar com a senha SSH`](command:reshpc.jobEnterPassword) no VSCode para ajustar este valor de forma criptografada.",
                        "readOnly": true,
                        "scope": "application",
                        "order": 3
                    },
                    "reshpc.connection.privRsaKey": {
                        "type": "string",
                        "markdownDescription": "Opcional à senha, informe o caminho para chave RSA privada para acesso SSH. Em geral, C:\\users\\CHAVE\\\\.ssh\\id_rsa (não é a .pub!).",
                        "scope": "application",
                        "order": 4
                    }
                }
            },
            {
                "title": "File and Folders",
                "properties": {
                    "reshpc.path.WindowsUnix": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "string"
                        },
                        "markdownDescription": "Relação `de-para` entre o caminho e Windows e o caminho Unix visto pelo Cluster.",
                        "scope": "application",
                        "order": 5
                    },
                    "reshpc.path.destination": {
                        "type": "string",
                        "markdownDescription": "Pasta absoluta ou relativa, no formato Windows, indicando o destino para onde serão realizados os clones e as simulações quando usando simulações com clone. Veja o README.md para exemplos. Qualquer valor diferente de ..\\ e .\\ (pasta pai e atual) implicará em não poder haver um mesmo job rodando para o modelo. Prefira configurar este item na `TAB` workspace.",
                        "default": "..\\",
                        "order": 6
                    },
                    "reshpc.path.folderFormat": {
                        "type": "string",
                        "default": "projectName_hash",
                        "enum": [
                            "YYYY.MM.DD_hash_projectName",
                            "YYYY.MM.DD_projectName_hash",
                            "YYYY.MM.DD_tag_hash_projectName",
                            "YYYY.MM.DD_projectName_tag_hash",
                            "YYYY.MM.DD_projectName_hash_tag",
                            "projectName_hash",
                            "projectName_tag_hash",
                            "projectName_YYYY.MM.DD_hash",
                            "projectName_YYYY.MM.DD_tag_hash",
                            "projectName_YYYY.MM.DD_hash_tag"
                        ],
                        "markdownDescription": "Define o formato da pasta de saída para o clone. Tags com combinação de números, `'V','v','.' '_' e '-'` são preferencialmente escolhidas (exemplos v1.0.1, V-1). Se não achar um tag, '0' é colocado no lugar.",
                        "scope": "application",
                        "order": 7
                    }
                }
            },
            {
                "title": "Slurm",
                "properties": {
                    "reshpc.scheduler.slurm": {
                        "type": "string",
                        "markdownDescription": "Opções extras para serem passadas ao SLURM inclusive **ACCOUNT** (p. ex., -A account, fila/partição: -p glb). Prefira configura na `TAB` Workspace.",
                        "default": "",
                        "order": 8
                    },
                    "reshpc.scheduler.cores": {
                        "type": "number",
                        "default": 1,
                        "minimum": 1,
                        "markdownDescription": "Numero de cores usados na simulação (--cpus-per-task). Prefira configurar este item na `TAB` Workspace.",
                        "order": 11
                    },
                    "reshpc.scheduler.ntasksPerNode": {
                        "type": "number",
                        "default": 1,
                        "minimum": 1,
                        "markdownDescription": "Numero de tarefas por nó (--ntasks-per-node). Nota: total de processos MPI (-np) = nodes * ntasks-per-node, quando usado MPI. Prefira configurar este item na `TAB` Workspace.",
                        "order": 12
                    },
                    "reshpc.scheduler.nodes": {
                        "type": "number",
                        "default": 1,
                        "minimum": 1,
                        "markdownDescription": "Numero de nós usados na simulação (--nodes). Prefira configurar este item na `TAB` Workspace.",
                        "order": 13
                    },
                    "reshpc.scheduler.mpiExtras": {
                        "type": "string",
                        "default": "",
                        "markdownDescription": "Opções extras para serem passadas ao mpirun. Prefira configurar este item na `TAB` Workspace.",
                        "order": 14
                    }
                }
            },

            {
                "title": "Solver",
                "properties": {
                    "reshpc.solver.name": {
                        "type": "string",
                        "default": "",
                        "markdownDescription": "Nome do simulador. Use o comando de [seleção de simuladores](command:reshpc.selectSimulName). Caso o simulador desejado não apareça [carregue uma configuração customizada](command:reshpc.loadCustomConfiguration) Prefira configurar este item na `TAB` workspace.",
                        "order": 9
                    },
                    "reshpc.solver.version": {
                        "type": "string",
                        "markdownDescription": "Versão do solver de simulação a depender do simulador escolhido (p. ex.: 2019.12, 2018.11, v6.0, etc). Veja exemplos no README, ou selecione uma [ versões da lista, de acordo com o simulador](command:reshpc.selectSimulVersion). Prefira configurar este item na `TAB` Workspace.",
                        "order": 10
                    },

                    "reshpc.solver.ExtraParams": {
                        "type": "string",
                        "markdownDescription": "Opções extras para serem passadas para o solver. Para o CMG, `-wait e -parasol` estarão sempre inclusos e também `-doms -log -log2 e -cputime` serão inclusos caso o campo esteja em branco. Prefira configurar este item na `TAB` Workspace.",
                        "default": "",
                        "order": 15
                    }
                }
            }
        ]
    },
    "scripts": {
        "vscode:prepublish": "npm run compile",
        "compile": "tsc -p ./",
        "watch": "tsc -watch -p ./",
        "pretest": "npm run compile && npm run lint",
        "lint": "eslint src",
        "test": "vscode-test"
    },
    "devDependencies": {
        "@types/mocha": "^10.0.7",
        "@types/node": "20.x",
        "@types/pubsub-js": "^1.8.6",
        "@types/sprintf-js": "^1.1.4",
        "@types/ssh2": "^1.15.1",
        "@types/vscode": "^1.92.0",
        "@typescript-eslint/eslint-plugin": "^8.3.0",
        "@typescript-eslint/parser": "^8.3.0",
        "@vscode/test-cli": "^0.0.10",
        "@vscode/test-electron": "^2.4.1",
        "@vscode/vsce": "^3.1.0",
        "eslint": "^9.9.1",
        "serve-static": "^1.16.2",
        "typescript": "^5.5.4"
    },
    "dependencies": {
        "axios": "^1.7.7",
        "cors": "^2.8.5",
        "crypto": "^1.0.1",
        "express": "^4.21.0",
        "flatted": "^3.3.1",
        "http-proxy-middleware": "^3.0.2",
        "iconv-lite": "^0.6.3",
        "math": "0.0.3",
        "mongodb": "^6.9.0",
        "morgan": "^1.10.0",
        "path": "^0.12.7",
        "pubsub-js": "^1.9.4",
        "simple-git": "^3.27.0",
        "sprintf-js": "^1.1.3",
        "ssh2": "^1.16.0",
        "ssh2-sftp-client": "^11.0.0"
    }
}
